<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Boarding House</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

    <section id="admin-login" class="active-screen">
        <div class="login-card">
            <h1>Admin Access</h1>
            <input type="password" id="admin-pass" placeholder="Admin Password" class="full-width">
            <button onclick="adminApp.login()" class="btn-primary full-width" style="margin-top: 1rem;">Enter</button>
        </div>
    </section>

    <section id="admin-dash" class="hidden max-container">
        <div class="admin-header">
            <h2>Manager Dashboard</h2>
            <button onclick="location.reload()" class="btn-logout">Logout</button>
        </div>

        <div class="card" style="margin-bottom: 20px;">
            <h3>ðŸ“¢ Post Announcement</h3>
            <input type="text" id="news-title" placeholder="Title (e.g., Water Interruption)" class="full-width">
            <textarea id="news-body" placeholder="Details..." style="width:100%; height:80px; padding:8px; margin: 10px 0; border: 1px solid var(--border); border-radius: 8px;"></textarea>
            <button onclick="adminApp.postNews()" class="btn-primary full-width">Post News</button>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 20px;">
            <div class="card">
                <h3>ðŸ§¾ Create Bill / SOA</h3>
                <div class="form-grid">
                    <select id="bill-room" onchange="adminApp.fetchReadings()" style="width:100%; padding:0.8rem; border:1px solid var(--border); border-radius:8px; font-size:1rem;">
                        <option value="">Select Room</option>
                    </select>
                    <input type="month" id="bill-month" onchange="adminApp.fetchReadings()">
                    <input type="number" id="bill-rental" placeholder="Rental Cost">
                    <input type="number" id="bill-water-reading" placeholder="Water Reading (mÂ³)" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
                    <input type="number" id="bill-electric-reading" placeholder="Electric Reading (kWh)" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
                    <input type="text" id="bill-due" placeholder="Due Date (e.g. Feb 15)">
                </div>
                <button onclick="adminApp.createBill()" class="btn-primary full-width" style="margin-top:10px;">Calculate & Send Bill</button>
            </div>

            <div class="card">
                <h3>ðŸ‘¥ Tenants</h3>
                <div class="tenants-table-container">
                    <table class="tenants-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Room No</th>
                            </tr>
                        </thead>
                        <tbody id="tenants-tbody">
                            <tr>
                                <td colspan="2" style="text-align:center; color:var(--text-muted);">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card" style="margin-bottom: 20px;">
            <h3>ðŸ“Š Monthly Meter Readings</h3>
            <p style="color:var(--text-muted); font-size:0.9rem; margin-bottom:1rem;">Input meter readings for each room</p>
            <div class="readings-table-container">
                <table class="readings-table">
                    <thead>
                        <tr>
                            <th>Room No</th>
                            <th>Water (mÂ³)</th>
                            <th>Electric (kWh)</th>
                            <th>Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="readings-tbody">
                        <tr>
                            <td><input type="text" placeholder="101" class="reading-input"></td>
                            <td><input type="number" placeholder="0.00" class="reading-input"></td>
                            <td><input type="number" placeholder="0.00" class="reading-input"></td>
                            <td><input type="date" class="reading-input"></td>
                            <td><button onclick="adminApp.saveReading(this)" class="btn-small">Save</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button onclick="adminApp.addReadingRow()" class="btn-secondary" style="margin-top:1rem; width:100%;">+ Add Row</button>
        </div>

        <div class="card">
            <h3>ðŸŽ« Open Tickets</h3>
            <div id="admin-tickets-list">
                <p>Loading tickets...</p>
            </div>
        </div>
    </section>

    <script src="admin.js"></script>
</body>
</html>